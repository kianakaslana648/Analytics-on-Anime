<!DOCTYPE html>
<html>
<head>
<title>Clustering</title>
<link rel="stylesheet" href="../css/style6.css">
</head>
<body class='back'>
	<div></div>
	<div class="container">
		<div class="title">Clustering</div>
		<HR width="100%" color=#987cb9 SIZE=1>
		<h2><i>Intro</i></h2>
		<table>
		    <tr>
			<td width=200px>
				<p>The goal of this part is trying to find appropriate classfications for current datasets using clustering methods.</p>
			</td>
		    </tr>
		</table>
		<HR width="100%" color=#987cb9 SIZE=1>
		<h2><i>About Datasets</i></h2>
		<br/>
		<h3><i>Record Data</i></h3>
		<table>
		    <tr>
			<td width=200px>
				<p>The record data comes from the following link. Its original source is <i>MyAnimeList</i></p>
				<p class='question'><a href='https://www.kaggle.com/natlee/myanimelist-comment-dataset'>kaggle.com/natlee/myanimelist-comment-dataset</a></p>
				<p>The link for downloading is here:</p>
				<p class='question'><a href='../datasets/animeReviewsOrderByTime.txt'>animeReviewsOrderByTime.txt</a></p>
				<p>It collects more than 130000 reviews composed of texts and ratings on animes. The description is here:<i></i></p>
				<div><img src="../pic/shot12.png" width=300px height=200px></div>
				<p>Then I eliminated all the non-numeric columns and fixed the missing values. The remaining columns are mostly about ratings on different aspects.</p>
			</td>
			<td width=100px></td>
			<td>
			    <i>A brief look:</i>
			    <div><img src="../pic/shot13.png" width=550px height=200px></div>
			</td>
		    </tr>
		</table>
		<br/>
		<h3><i>Text Data</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>The text data is the clean data from the <i>Data Cleaning</i> part, which is a Document-Word matrix of bullet screens contained by 51 episodes from 4 animes. (With episodes being the line, animes being the label.)</p><p> In fact I made some adjustments to the original data-cleaning codes--I added more stopwords because that's necessary for achieving better results in this part.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>A brief look:</i>
		        <div><img src="../pic/shot14.png" width=500px height=300px></div>
		    </td>
		    </tr>
		</table>
		<HR width="100%" color=#987cb9 SIZE=1>
		<h2><i>R Part</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        I wanted to use different clustering methods to find if reviews could be classified by the ratings on different aspects as well as some other attributes.
		    </td>
		    </tr>
		</table>
		<br/>
		<h2><i>K-Means</i></h2>
		<h3 class='subtitle'><i>Best Choice of K</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		       <p>I used the methods of <i>Elbow</i>, <i>Silhouette</i>, <i>Gap_Stat</i>. The results showed that the best K may be between 2 and 5.</p> 
		        <p>In <i>Elbow</i> method, we calculate Total Within Sum of Square for each K. If at some point the sum decreases most dramatically, we think that's the best K. One possible way to have an automatic algorithm is to calculate the tangent values of angles formed by the two intersected lines at each point and select the one with the largest absolute value.</p>
		        <p>In <i>Silhouette</i> method, we use a metric to describe the distances of elements in the same group and the distances between different groups. The larger the metric value, the more likely elements within the same group are close to each to other and the more likely different groups are away from each other. The advantage of this method is that we can simply select the maximum point as the best K.</p>
		        <p>In <i>Gap_Stat</i> method, we use a Monte-Carlo simulation to calculate a metric somehow relevant to entropy decrease. The computation process is obviously much longer than the above two.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>Elbow:</i>
		        <div><img src="../pic/shot15.png" width=300px height=300px></div>
		        <i>Silhouette:</i>
		        <div><img src="../pic/shot16.png" width=300px height=300px></div>
		        <i>Gap_Stat:</i>
		        <div><img src="../pic/shot17.png" width=300px height=300px></div>
		    </td>
		    </tr>
		</table>
		<h3 class='subtitle'><i>K-Means Process</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>I apply the K-Means by having the k=2,3,4,5. What I achieved are different classifications which could be used as the labels for the reviews.</p>
		        <p>By using the visualization generated by <i>fviz_cluster</i>, we can observe that the classification is mainly impacted by the first component in PCA. And as k increases, impacts of other components on the classification increase.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <div><img src="../pic/shot18.png" width=200px height=200px></div>
		        <div><img src="../pic/shot19.png" width=200px height=200px></div>
		        <div><img src="../pic/shot20.png" width=200px height=200px></div>
		        <div><img src="../pic/shot21.png" width=200px height=200px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>Hierarchical Clustering</i></h2>
		<table>
		    <tr>
		    <td width=400px>
		        I decided to perform the Hierarchical Clustering on the subset of reviews on one anime. (Parallel computation is not supported in R, computation of distance matrices on the whole dataset would cause memory overflow. So what I can do is just restrict it on a much smaller subset.)
		    </td>
		    </tr>
	    </table>
		<h3 class='subtitle'><i>Distance Matrix under Different Metrics</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>I computed the distance matrices under metrics of Euclidean metric, Manhattan metric and Cosine metric.</p>
		        <p>The corresponding code is attached on the right.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <div><img src="../pic/shot22.png" width=300px height=150px></div>
		    </td>
		    </tr>
		</table>
		<h3 class='subtitle'><i>Dendrogram</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>I drew the three dendrograms under different metrics. The dendrograms are somehow different from each other.</p>
		        <p>Directly, estimation of the best choice of K may be between 2 and 5.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>Euclidean</i>
		        <div><img src="../pic/shot25.png" width=200px height=200px></div>
		        <i>Manhattan</i>
		        <div><img src="../pic/shot26.png" width=200px height=200px></div>
		        <i>Cosine</i>
		        <div><img src="../pic/shot27.png" width=200px height=200px></div>
		    </td>
		    </tr>
		</table>
		<h3 class='subtitle'><i>Best Choice of K</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>By using the function of <i>fvis_nbclust</i>, we can have the pic on the right.</p>
		        <p>So we choose K to be 5.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>Gap_Stat</i>
		        <div><img src="../pic/shot24.png" width=200px height=200px></div>
		    </td>
		    </tr>
		</table>
		<h3 class='subtitle'><i>2D Visualizations given K = 5</i></h3>
		<table>
		    <tr>
		    <td width=200px>
		        <p>We have the pics on the right.</p>
		        <p>We can see while the cosine metric is different from the other two, the Euclidean and Manhattan metrics are similar. Perhaps that's because they are both special cases of Minkowski metric.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>Euclidean</i>
		        <div><img src="../pic/shot28.png" width=200px height=200px></div>
		        <i>Manhattan</i>
		        <div><img src="../pic/shot29.png" width=200px height=200px></div>
		        <i>Cosine</i>
		        <div><img src="../pic/shot30.png" width=200px height=200px></div>
		    </td>
		</table>
		<h2><i>Short Summary</i></h2>
		<table>
		    <tr>
		    <td width=400px>
		        <p>By applying different clustering methods, I can achieve different labels for the original dataset.</p>
		        <p>One downside of <i>fviz_cluster</i> is that we do not know how much each of the original columns contribute to the first component in PCA.</p>
		        <p>Since humans could only perceive images of no more than 3D, maybe it's better to use some numerical metrics the mesure how much each dimension contribute to the clustering result.</p>
		        <p>It's really difficult to find huge datasets with many numeric columns on the topic of anime. Almost all the datasets are about ratings or images. Maybe the anime datasets are more suitable for CV. But it's still a good practice for me.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		    </td>
		</table>
		<h2><i>Rscripts</i></h2>
		<p>The link of the Rscript, which did all the things above, is here:</p>
		<p class='question'><a href='../Rscripts/Clustering/clustering.r'>clustering.r</a></p>
		<HR width="100%" color=#987cb9 SIZE=1>
		<h2><i>Python Part</i></h2>
		<p>By using the clustering methods, I want to have the correct classficition for bullet screens of episodes from different animes.</p>
		<br/>
		<h2><i>Best Choice of K</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        <p>Using the Elbow method, I want to find out the approximate ranges for good choices of K.</p>
		        <p>That's between 2 and 4. (Although we can have an automatic selection algorithm for Elbow method, I think it's better to check the values around the best options when the best K is rather small.)</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <div><img src="../pic/shot31.png" width=300px height=200px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>K-Means</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        <p>Although it is supposed that the best K should be within [2,4], the smallest K to classify the datasets into 4 animes is 9.</p><p>It seems that always the last episodes of each anime are first deteced to be within the same cluster and then the difference of some special episodes and finally the difference of episodes in four animes.</p><p>Quite frustrating.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <div><img src="../pic/shot32.png" width=400px height=100px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>Agglomerative Clustering</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        <p>The similar situation happens in Agglomerative Clustering with Euclidean and Manhattan metrics. The smallest Ks to detect the different of 4 animes are 9 and 8.</p>
		        <p>But there is a rather excellent result in Agglomerative Clustering with Cosine metrics. The best K is 5.</p><p>The model first detects the difference of the last episodes of each anime. And then within 4 step of increase, the model is able to classify all the remaining episodes into 4 animes.</p>
		        <p>Perhaps Cosine metrics is just suitable for this situation.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <i>Euclidean</i>
		        <div><img src="../pic/shot33.png" width=400px height=100px></div>
		        <i>Manhattan</i>
		        <div><img src="../pic/shot34.png" width=400px height=100px></div>
		        <i>Cosine</i>
		        <div><img src="../pic/shot35.png" width=400px height=100px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>DBSCAN</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        <p>DBSCAN just doesn't work well here no matter what epsilon is selected.</p><p>I think that's because there are only 51 points here and the differences are not that obvious.</p> 
		    </td>
		    <td width=200px></td>
		    <td>
		        <div><img src="../pic/shot36.png" width=400px height=100px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>Features in the Last Episodes</i></h2>
		<table>
		    <tr>
		    <td width=200px>
		        <p>In order to solve the mystery, I created the wordcloud visuals of each episodes and I found the answer.</p>
		        <p>In the last episode of each anime, users always create bullet screens containing words of  <i>Goodbye</i>  <i>End</i>  <i>Grateful</i>  <i>Thanks</i>  <i>Accompany</i>. (I made my best to translate those into English.)In Chinese, those are words to show gratitude, expressing unwillingness to part, which are reasonable and unique for the last episode.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		        <h3><i>Black-Heart Company</i></h3>
		        <i>Episode 8 and 10</i>
		        <div><img src="../pic/black_heart_p8.png" width=300px height=200px></div>
		        <div><img src="../pic/black_heart_p10.png" width=300px height=200px></div>
		        <i>The Last Episode</i>
		        <div><img src="../pic/black_heart_p12.png" width=300px height=200px></div>
		    </td>
		    </tr>
		</table>
		<h2><i>Short Summary</i></h2>
		<table>
		    <tr>
		    <td width=400px>
		        <p>The cosine distance metric is suitable for classifying the bullet screens here. That's kind of interesting.</p>
		        <p>If I add more words to the stopword set about the last-episode words, I can achieve a even better result. But those words are something precious recording the audience's feelings. So I choose to reserve them.</p>
		    </td>
		    <td width=200px></td>
		    <td>
		    </td>
		    </tr>
		</table>
		<h2><i>Python scripts</i></h2>
		<p>The link of the Python scripts, which did all the things above, is here:</p>
		<p class='question'><a href='../pythonscripts/Clustering/clustering.ipynb'>clustering.ipynb</a></p>
		<HR width="100%" color=#987cb9 SIZE=1>
		<table>
		    <tr>
		        <td>
        		<div class='nextdiv'>
        			<a class='nextpart' href='../html/Exploring Data.html' target="_blank">Last Part: Exploring Data</a>
        		</div>
        		</td>
        		<td width=200px>
        		</td>
        		<td>
        		<div class='nextdiv'>
        			<a class='nextpart' href='../html/ARM and Networking.html' target="_blank">Next Part: ARM and Networking</a>
        		</div>
        		</td>
        	</tr>
        </table>
		<br/>
	</div>
	    <br/>
	    <br/>
	    <br/>
		<div class="underworld">
		<div class="coolwords">
			Bemoaning the obligations you choose to uphold dutifully is evil and to praise that pain is an insult only to yourself. <br/><br/>What should be praised is the triumphs you achieved. The pain in your heart is for you alone.
		</div>
		<div class="symbol">
			<img src="../pic/Gilgamesh_pic.png" width=100px height=100px>
		</div>
		<div>
		</div>
	    </div>
</body>
</html>